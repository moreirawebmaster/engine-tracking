# Changelog

All notable changes to this project will be documented in this file.

The format is based on [Keep a Changelog](https://keepachangelog.com/en/1.0.0/),
and this project adheres to [Semantic Versioning](https://semver.org/spec/v2.0.0.html).

## [1.4.0] - 2025-01-24

### Added
- **üé• Microsoft Clarity Integration**: Complete integration with official Clarity Flutter SDK for behavioral analytics
- **EngineClarityConfig**: Configuration class for Microsoft Clarity with Project ID, User ID, and LogLevel support
- **Masking Widgets**: `EngineMaskWidget` and `EngineUnmaskWidget` for protecting sensitive content
- **Example App**: Complete example demonstrating Clarity integration with masking examples

### Enhanced
#### Microsoft Clarity Features
- **Session Recordings**: Automatic capture of user sessions for replay
- **Heatmaps**: Visual representation of user interactions
- **User Insights**: Automatic detection of rage taps, dead taps, excessive scrolling
- **Auto-tracking**: Automatic capture of navigation and user interactions
- **Zero Configuration Events**: No manual event logging needed - Clarity captures automatically

#### Architecture Updates
- **EngineAnalyticsModel**: Added `clarityConfig` property for Clarity configuration
- **EngineAnalytics**: Added `isClarityInitialized`
- **Widget Exports**: Added Clarity masking widgets to widget exports
- **Adapter Pattern**: Adapted Clarity's unique widget-based initialization to Engine Tracking architecture

### Dependencies
- **clarity_flutter: ^1.0.0**: Official Microsoft Clarity Flutter SDK

### Technical Details
- **Unique Implementation**: Clarity requires wrapping the app with ClarityWidget instead of static methods
- **LogLevel Support**: Automatic production optimization (LogLevel.None in release builds)
- **User ID Validation**: Base-36 format validation for Clarity user IDs
- **Session Recording**: ~30 minutes for real-time viewing, ~2 hours for complete processing

## [1.3.0] - 2025-01-23

### Added
- **üÜî Session ID Autom√°tico**: Sistema de correla√ß√£o de logs e analytics atrav√©s de UUID v4 √∫nico por sess√£o
- **EngineSession**: Nova classe singleton para gerenciamento de Session ID
- **Auto-inject**: Session ID inclu√≠do automaticamente em todos os eventos e logs
- **Valida√ß√£o RFC 4122**: Formato UUID v4 compat√≠vel com qualquer sistema
- **Testes Completos**: 9 testes unit√°rios para Session ID com valida√ß√£o de conformidade

### Enhanced
#### Sistema de Session ID
- **Zero Configura√ß√£o**: Session ID gerado automaticamente na primeira chamada
- **Correla√ß√£o Universal**: UUID v4 inclu√≠do em Firebase Analytics, Google Cloud Logging, Crashlytics e Faro
- **Singleton Pattern**: Mesma inst√¢ncia durante toda a vida do app
- **Formato Padr√£o**: `xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx` (RFC 4122 UUID v4)
- **Test√°vel**: M√©todo `resetForTesting()` para cen√°rios de teste

#### Integra√ß√£o Autom√°tica
- **Firebase Analytics**: Session ID em todos os eventos automaticamente
- **Google Cloud Logging**: Correlation ID para agrupamento de logs
- **EngineLog**: Session ID inclu√≠do em todos os n√≠veis de log
- **M√©todo Enrich**: `enrichWithSessionId()` para auto-inject em dados

#### Arquitetura Atualizada
- **Diagrama Mermaid**: Novo diagrama mostrando fluxo do Session ID
- **Documenta√ß√£o Completa**: Se√ß√£o dedicada com exemplos pr√°ticos
- **Casos de Uso**: Exemplos de correla√ß√£o em pain√©is de analytics

### Quality Improvements
- **96 Testes Passando**: Atualiza√ß√£o de 87 para 96 testes (100% de sucesso)
- **UUID v4 Conformance**: Valida√ß√£o completa do formato RFC 4122
- **Unicidade Testada**: Verifica√ß√£o de 1000/1000 UUIDs √∫nicos gerados
- **Performance**: Gera√ß√£o eficiente de UUID sem depend√™ncias externas

### Documentation
- **README Atualizado**: Se√ß√£o completa sobre Session ID
- **Exemplos Pr√°ticos**: Como usar Session ID para correla√ß√£o de logs
- **Queries de Exemplo**: Como consultar logs por session_id nos pain√©is
- **Melhores Pr√°ticas**: Uso do Session ID para an√°lise de jornada do usu√°rio

## [1.2.1] - 2025-01-15

### Enhanced
#### üìã Documenta√ß√£o de Arquitetura
- **Diagramas Mermaid**: Adicionados 4 diagramas completos da arquitetura no README:
  - **Widgets Stateless/Stateful**: Mostra execu√ß√£o de m√©todos e lifecycle tracking
  - **Sistema de Logging (EngineLog)**: Fluxo detalhado com condicionais de Analytics e Bug Tracking
  - **Sistema de Analytics**: Arquitetura de adapters e integra√ß√£o com dashboards
  - **Sistema de Bug Tracking**: Fluxo de captura de erros e crash reporting

#### üîß Melhorias no Diagrama EngineLog
- **Condicionais Claras**: Representa√ß√£o visual das condi√ß√µes `EngineAnalytics.isEnabled && includeInAnalytics`
- **Fluxo de Erro**: Mostra que logs de level `error` e `fatal` geram crash reporting adicional
- **Nomenclatura Melhorada**: Par√¢metro `includeInAnalytics` mais descritivo que `hasAnalytics`
- **Estiliza√ß√£o Visual**: Condicionais destacadas com cores para melhor legibilidade

#### üé® Recursos Visuais
- **Cores Organizadas**: Paleta de cores consistente por tipo de componente
- **Formas Diferenciadas**: Losangos para condicionais, ret√¢ngulos para componentes
- **Legenda Inclu√≠da**: Facilita compreens√£o da arquitetura
- **Fluxo Hier√°rquico**: Visualiza√ß√£o clara do fluxo de dados de cima para baixo

### Documentation
- **Arquitetura Completa**: Se√ß√£o dedicada mostrando como toda a solu√ß√£o funciona integrada
- **Fluxos Condicionais**: Demonstra quando Analytics e Bug Tracking s√£o ativados
- **Representa√ß√£o Fiel**: Diagramas 100% alinhados com a implementa√ß√£o real do c√≥digo

## [1.1.1] - 2025-01-23

### Added
- **üåê HTTP Tracking Example**: Novo exemplo completo demonstrando tracking de requisi√ß√µes HTTPS

### Enhanced
#### Exemplo HTTP Tracking
- **Pok√©API Integration**: Demonstra√ß√£o de requisi√ß√µes GET para dados de pok√©mons
- **JSONPlaceholder Integration**: Exemplo completo com GET e POST para posts e usu√°rios
- **M√©tricas Detalhadas**: Tracking autom√°tico de:
  - Tempo de resposta em milissegundos
  - C√≥digos de status HTTP
  - Tamanho das respostas em bytes
  - Sucesso/falha das requisi√ß√µes
  - Timestamps completos
- **Tratamento de Erros**: Sistema robusto de captura e logging de erros HTTP
- **Interface Responsiva**: Design adaptativo com scroll autom√°tico

#### Funcionalidades das APIs
- **Pokemon List Page**: Lista interativa de pok√©mons com detalhes em modal
- **Posts List Page**: Visualiza√ß√£o e cria√ß√£o de posts com tracking completo
- **Users List Page**: Lista detalhada de usu√°rios com informa√ß√µes completas

#### Sistema de Tracking
- **EngineStatelessWidget**: Implementa√ß√£o otimizada para tracking autom√°tico

### Fixed
- **Code Organization**: Otimiza√ß√£o do c√≥digo com redu√ß√£o de linhas desnecess√°rias

### Dependencies
- **http: ^1.1.0**: Adicionada para requisi√ß√µes HTTP no exemplo

## [1.1.0] - 2025-01-23

### Added
- **Sistema de Configura√ß√£o Aprimorado**: Nova arquitetura de configura√ß√£o com modelos padr√£o
- **Cobertura de Testes Abrangente**: 62 testes de unidade com cobertura superior a 95% nas configura√ß√µes
- **Documenta√ß√£o Completa**: README detalhado com exemplos pr√°ticos de uso
- **Exemplos de View Tracking**: Sistema completo de tracking de telas e a√ß√µes de usu√°rio

### Enhanced
#### Configura√ß√£o de Analytics
- `EngineAnalyticsModel`: Modelo principal para configura√ß√£o de analytics
- `EngineAnalyticsModelDefault`: Implementa√ß√£o padr√£o com servi√ßos desabilitados por seguran√ßa
- `EngineFirebaseAnalyticsConfig`: Configura√ß√£o espec√≠fica do Firebase Analytics
- Reutiliza√ß√£o da configura√ß√£o Faro para integra√ß√£o dual

#### Sistema de Analytics Refatorado
- **EngineAnalytics**: Refatorado para usar sistema de configura√ß√£o baseado em modelos
- **Construtor Privado**: Implementa√ß√£o de padr√£o singleton com m√©todos est√°ticos apenas
- **Inicializa√ß√£o Condicional**: Servi√ßos inicializam apenas quando habilitados
- **M√©todo Reset**: Suporte para reset de configura√ß√£o (√∫til para testes)

#### Testes de Unidade
- `engine_firebase_analytics_config_test.dart`: 8 testes para configura√ß√£o Firebase
- `engine_analytics_model_test.dart`: 8 testes para modelos de analytics
- `engine_analytics_test.dart`: 6 testes para funcionalidades principais
- `engine_crashlytics_config_test.dart`: 8 testes para configura√ß√£o Crashlytics
- `engine_faro_config_test.dart`: 8 testes para configura√ß√£o Faro
- `engine_bug_tracking_model_test.dart`: 8 testes para modelos de bug tracking
- `engine_bug_tracking_test.dart`: 6 testes para funcionalidades de bug tracking
- `engine_log_level_test.dart`: 5 testes para n√≠veis de log
- `engine_log_test.dart`: 7 testes para sistema de logging

#### Exemplos Pr√°ticos
- **View Tracking Example**: Aplica√ß√£o completa demonstrando tracking de views
- **Mixins de Tracking**: `EngineStatelessWidget` e `EngineStatefulWidget`
- **Tracking Autom√°tico**: Sistema autom√°tico de tracking de entrada e sa√≠da de telas
- **Par√¢metros Customizados**: Suporte a par√¢metros espec√≠ficos por tela
- **Eventos de Usu√°rio**: Logging de a√ß√µes, mudan√ßas de estado e eventos customizados

### Fixed
- **Null Safety**: Corre√ß√£o de campos `late final` para nullable evitando erros de inicializa√ß√£o
- **Depend√™ncias Firebase**: Isolamento adequado de depend√™ncias para testes
- **Arquitetura Static**: Padroniza√ß√£o de toda API p√∫blica como m√©todos est√°ticos

### Documentation
- **README Atualizado**: Documenta√ß√£o completa com:
  - Instala√ß√£o e configura√ß√£o passo a passo
  - Exemplos de uso para Analytics e Bug Tracking
  - Configura√ß√µes avan√ßadas por ambiente
  - Melhores pr√°ticas de implementa√ß√£o
  - Suporte a todas as plataformas Flutter

### Quality Improvements
- **Cobertura de Testes**: 
  - Config Files: 100% (3/3 arquivos)
  - Model Files: 100% (2/2 arquivos)
  - Logging: 77% (24/31 linhas)
  - Cobertura Total: 33.5% (62 de 185 linhas execut√°veis)
- **62 Testes Passando**: 100% de sucesso em todos os testes
- **Arquitetura Consistente**: Padroniza√ß√£o com prefixo "Engine" em todas as classes
- **Type Safety**: Implementa√ß√£o tipo-segura em toda a biblioteca

### Breaking Changes
- `EngineAnalyticsService` renomeado para `EngineAnalytics` (consist√™ncia de nomenclatura)
- Remo√ß√£o de providers individuais em favor do sistema de configura√ß√£o baseado em modelos
- API de inicializa√ß√£o alterada para usar modelos de configura√ß√£o

### Migration Guide
```dart
// Antes (v1.0.x)
await EngineAnalyticsService.initialize(/* ... */);

// Agora (v1.1.0+)
final analyticsModel = EngineAnalyticsModel(
  firebaseConfig: EngineFirebaseAnalyticsConfig(
    enabled: true,
  ),
  faroConfig: EngineFaroConfig(
    enabled: true,
    endpoint: 'https://faro.example.com',
    // ... outras configura√ß√µes
  ),
);
await EngineAnalytics.initWithModel(analyticsModel);
```

## [1.0.1] - 2025-06-23

### Added
- **Complete CI/CD Infrastructure**: Comprehensive GitHub Actions pipeline for automated testing, analysis, and publishing
- **Code Quality Integration**: Pana analysis with perfect 160/160 score requirement
- **Code Coverage Tracking**: Codecov integration with 49.5% coverage (45% target)
- **Professional Issue Templates**: Structured templates for bug reports and feature requests
- **Development Automation**: Scripts for automated testing and quality analysis
- **Quality Assurance**: Weekly automated security and dependency audits

### Infrastructure Files Added
```
.github/
‚îú‚îÄ‚îÄ workflows/
‚îÇ   ‚îú‚îÄ‚îÄ ci.yml              # Main CI pipeline (tests, analysis, coverage)
‚îÇ   ‚îú‚îÄ‚îÄ publish.yml         # Automatic pub.dev publishing on tags
‚îÇ   ‚îî‚îÄ‚îÄ quality.yml         # Weekly quality and security checks
‚îú‚îÄ‚îÄ issue_template/
‚îÇ   ‚îú‚îÄ‚îÄ bug_report.md       # Structured bug reporting template
‚îÇ   ‚îî‚îÄ‚îÄ feature_request.md  # Feature request template with priority
‚îú‚îÄ‚îÄ pull_request_template.md # Comprehensive PR review template
‚îî‚îÄ‚îÄ README.md               # CI/CD infrastructure documentation

codecov.yml                 # Code coverage configuration (45% target)
pana_config.yaml           # Package analysis configuration (160/160 score)
scripts/
‚îú‚îÄ‚îÄ test_coverage.sh       # Automated test coverage with HTML reports
‚îî‚îÄ‚îÄ pana_analysis.sh       # Package quality analysis script
```

### CI/CD Features
- **Automated Testing**: Complete test suite execution with coverage reporting
- **Code Quality**: Integrated Pana analysis and Flutter code analysis
- **Format Validation**: Automatic code formatting verification
- **Publishing Automation**: Tag-based automatic publishing to pub.dev
- **Security Audits**: Weekly dependency and security analysis
- **Coverage Integration**: Codecov reporting with PR comments

### Quality Standards Achieved
- ‚úÖ **Pana Score**: 160/160 (Perfect)
- ‚úÖ **Tests**: 83 passing (100% success rate)
- ‚úÖ **Coverage**: 49.5% (exceeds 45% target)
- ‚úÖ **Linting**: 0 warnings, 0 errors
- ‚úÖ **Formatting**: 100% compliant

### Configuration Optimizations
- **Branch Strategy**: Streamlined to main branch workflow
- **Template Internationalization**: English templates for global accessibility
- **Publishing Method**: Direct `dart pub publish` with secure credential management
- **Quality Requirements**: Perfect Pana score enforcement

## [1.0.0] - 2025-01-22

### Added
- Initial release of `engine_tracking` package
- **EngineAnalytics**: Complete analytics system supporting Firebase Analytics and Grafana Faro
- **EngineBugTracking**: Bug tracking system with Firebase Crashlytics and Grafana Faro integration
- **EngineLog**: Structured logging system with multiple log levels
- **Configuration Models**: Type-safe configuration classes for all services
- **Dual Integration**: Simultaneous support for Firebase and Grafana Faro services
- **Conditional Initialization**: Services initialize only when enabled in configuration
- **Static API**: All public methods are static for easy access

### Features
#### Analytics (EngineAnalytics)
- Event logging with custom parameters
- User identification and properties
- Page/screen tracking
- App open events
- Firebase Analytics integration
- Grafana Faro integration

#### Bug Tracking (EngineBugTracking)
- Error recording with stack traces
- Flutter error handling
- User identification
- Custom key-value logging
- Structured logging with levels
- Firebase Crashlytics integration
- Grafana Faro integration

#### Configuration
- `EngineAnalyticsModel`: Analytics configuration model
- `EngineFirebaseAnalyticsConfig`: Firebase Analytics configuration
- `EngineBugTrackingModel`: Bug tracking configuration model
- `EngineCrashlyticsConfig`: Crashlytics configuration
- `EngineFaroConfig`: Grafana Faro configuration (shared)

#### System
- `EngineLogLevelType`: Log level enumeration
- `EngineLog`: Structured logging implementation

### Supported Platforms
- ‚úÖ iOS
- ‚úÖ Android

### Dependencies
- `firebase_core: ^3.14.0`
- `firebase_analytics: ^11.5.0`
- `firebase_crashlytics: ^4.3.7`
- `faro: ^0.3.6`

### Development
- Flutter lints for code quality
- Dart SDK compatibility: `>=3.8.0 <4.0.0`
- Flutter compatibility: `>=3.32.0`

---

## [Unreleased]

### Planned Features
- Web platform support
- macOS platform support  
- Windows platform support
- Linux platform support
- Advanced filtering options
- Performance monitoring integration
- Custom event validation 